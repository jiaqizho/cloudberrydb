-- start_matchignore
-- m/LOG:  statement:/
-- m/no filter/
-- m/scan key build success/
-- end_matchignore
set default_table_access_method to pax;
set pax_enable_debug to on;
set pax_enable_filter to on;
set pax_max_tuples_per_group to 5;
set vector.enable_vectorization to on;
-- 
-- Test the oid min/max types support 
-- 
create table t_oid(i int, v oid) with(minmax_columns='v');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'i' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_oid(i, v) values(1, generate_series(1, 10));
insert into t_oid(i, v) values(1, generate_series(10, 20));
set client_min_messages to log;
select count(*) from t_oid where v > 0::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_oid where v > 5::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_oid where v > 10::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_oid where v > 15::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_oid where v > 20::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v < 0::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v < 6::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_oid where v < 11::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    11
(1 row)

select count(*) from t_oid where v < 16::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_oid where v < 21::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_oid where v = 0::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v = 5::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_oid where v = 10::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     2
(1 row)

select count(*) from t_oid where v = 11::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_oid where v = 20::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_oid where v = 21::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v >= 0::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_oid where v >= 6::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_oid where v >= 11::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_oid where v >= 16::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_oid where v >= 21::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v <= 0::oid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_oid where v <= 5::oid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_oid where v <= 10::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    11
(1 row)

select count(*) from t_oid where v <= 15::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_oid where v <= 20::oid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

reset client_min_messages;
LOG:  statement: reset client_min_messages;
drop table t_oid;
-- 
-- Test the money min/max types support 
-- 
create table t_cash(i int, v money) with(minmax_columns='v');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'i' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_cash(i, v) values(1, generate_series(1, 10));
insert into t_cash(i, v) values(1, generate_series(10, 20));
set client_min_messages to log;
-- current type can't compare with int2/int4/int8
select count(*) from t_cash where v > 0::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_cash where v > 5::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_cash where v > 10::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_cash where v > 15::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_cash where v > 20::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v < 0::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v < 6::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_cash where v < 11::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    11
(1 row)

select count(*) from t_cash where v < 16::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_cash where v < 21::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_cash where v = 0::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v = 5::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_cash where v = 10::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     2
(1 row)

select count(*) from t_cash where v = 11::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_cash where v = 20::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_cash where v = 21::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v >= 0::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

select count(*) from t_cash where v >= 6::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_cash where v >= 11::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_cash where v >= 16::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_cash where v >= 21::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v <= 0::money;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_cash where v <= 5::money;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_cash where v <= 10::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    11
(1 row)

select count(*) from t_cash where v <= 15::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    16
(1 row)

select count(*) from t_cash where v <= 20::money;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    21
(1 row)

reset client_min_messages;
LOG:  statement: reset client_min_messages;
drop table t_cash;
-- 
-- Test the uuid min/max types support 
-- 
create table t_uuid(i int, v uuid) with(minmax_columns='v');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'i' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_uuid(i, v) values (1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a12'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a13'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a14'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a16'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a17'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a18'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a19'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a20');
insert into t_uuid(i, v) values (1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a21'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a22'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a23'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a24'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a25'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a26'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a27'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a28'),(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a29'),
(1, 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a30');
set client_min_messages to log;
-- current type can't compare with int2/int4/int8
select count(*) from t_uuid where v > 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a10'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    20
(1 row)

select count(*) from t_uuid where v > 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    15
(1 row)

select count(*) from t_uuid where v > 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a20'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_uuid where v > 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a25'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_uuid where v > 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a30'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v < 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v < 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a16'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_uuid where v < 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a21'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_uuid where v < 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a26'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    15
(1 row)

select count(*) from t_uuid where v < 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a31'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    20
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a00'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a20'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a21'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a30'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     1
(1 row)

select count(*) from t_uuid where v = 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a31'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v >= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    20
(1 row)

select count(*) from t_uuid where v >= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a16'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    15
(1 row)

select count(*) from t_uuid where v >= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a21'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_uuid where v >= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a26'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_uuid where v >= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a31'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v <= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a00'::uuid;
LOG:  kind file, filter rate: 2 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     0
(1 row)

select count(*) from t_uuid where v <= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
     5
(1 row)

select count(*) from t_uuid where v <= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a20'::uuid;
LOG:  kind file, filter rate: 1 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    10
(1 row)

select count(*) from t_uuid where v <= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a25'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    15
(1 row)

select count(*) from t_uuid where v <= 'a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a30'::uuid;
LOG:  kind file, filter rate: 0 / 2  (seg1 slice1 10.13.9.100:7003 pid=10967)
 count 
-------
    20
(1 row)

reset client_min_messages;
LOG:  statement: reset client_min_messages;
drop table t_uuid;
reset pax_enable_debug;
reset pax_enable_filter;
reset pax_max_tuples_per_group;
reset vector.enable_vectorization;
