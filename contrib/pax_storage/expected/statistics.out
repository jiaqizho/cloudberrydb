set default_table_access_method = pax;
CREATE OR REPLACE FUNCTION "get_pax_aux_table"(table_name text)
  RETURNS TABLE("ptblockname" name,"pttupcount" integer, 
    "ptstatistics" pg_ext_aux.paxauxstats, 
    "ptexistvisimap" bool, "ptexistexttoast" bool) AS $BODY$
    DECLARE
    subquery  varchar;
    pre_sql   varchar;
    table_oid Oid;
    begin
    pre_sql:='select oid from pg_class where relname='''||table_name||'''';
    EXECUTE pre_sql into table_oid;
    subquery := 'select ptblockname, pttupcount, ptstatistics, ptvisimapname IS NOT NULL AS ptexistvisimap, ptexistexttoast from gp_dist_random(''pg_ext_aux.pg_pax_blocks_'||table_oid||''')';
    RETURN QUERY execute subquery;
    END
    $BODY$
  LANGUAGE plpgsql;
-- 
-- Test with small group
-- 
set pax_max_tuples_per_group = 10;
-- overview
create table t1(v1 int, v2 text, v3 float8, v4 bool) with (minmax_columns='v1,v2,v3,v4');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 select i,i::text,i::float8, i % 2 > 0 from generate_series(1, 1000)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                                                                      ptstatistics                                                                      | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),(2,1000),(166662)],[(false,false),(338),(1000,999),None],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(f,t),None] | f              | f
 0           |        322 | [(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),None],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(f,t),None]      | f              | f
 0           |        340 | [(false,false),(340),(5,997),(172558)],[(false,false),(340),(10,997),None],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(f,t),None]     | f              | f
(3 rows)

drop table t1;
-- test `hasnull/allnull`/`count`, not need setting the minmax_columns
create table t1(v1 int, v2 float8);
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 values(generate_series(1, 1000), NULL);
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                        ptstatistics                         | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),None,None],[(true,true),(0),None,None] | f              | f
 0           |        340 | [(false,false),(340),None,None],[(true,true),(0),None,None] | f              | f
 0           |        322 | [(false,false),(322),None,None],[(true,true),(0),None,None] | f              | f
(3 rows)

truncate t1;
insert into t1 select NULL, NULL from generate_series(1, 200)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                      ptstatistics                       | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------------------+----------------+-----------------
 0           |        200 | [(true,true),(0),None,None],[(true,true),(0),None,None] | f              | f
(1 row)

truncate t1;
insert into t1 SELECT (CASE WHEN i % 2 > 0 THEN NULL ELSE i END), (CASE WHEN i % 2 < 1 THEN NULL ELSE i END) FROM generate_series(1, 1000)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                         ptstatistics                          | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------------------------+----------------+-----------------
 0           |        670 | [(false,true),(170),None,None],[(false,true),(500),None,None] | f              | f
 0           |        170 | [(false,false),(170),None,None],[(true,true),(0),None,None]   | f              | f
 0           |        160 | [(false,false),(160),None,None],[(true,true),(0),None,None]   | f              | f
(3 rows)

truncate t1;
drop table t1;
-- test `sum`
create table t1(v1 int2, v2 int4, v3 int8, v4 float4, v5 float8, v6 money, v7 interval) with (minmax_columns='v1,v2,v3,v4,v5,v6,v7');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 values(generate_series(1, 1000), generate_series(1, 1000), generate_series(1, 1000), 
  generate_series(1, 1000), generate_series(1, 1000), generate_series(1, 1000), (interval '3 seconds'));
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                                                                                                                                          ptstatistics                                                                                                                                           | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),None,($166,662.00)],[(false,false),(338),None,(@ 16 mins 54 secs)] | f              | f
 0           |        340 | [(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),None,($172,558.00)],[(false,false),(340),None,(@ 17 mins)]              | f              | f
 0           |        322 | [(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),None,($161,280.00)],[(false,false),(322),None,(@ 16 mins 6 secs)]       | f              | f
(3 rows)

drop table t1;
create table t_int2(v1 int2) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int2 values(generate_series(1, 1000));
select * from get_pax_aux_table('t_int2');
 ptblockname | pttupcount |              ptstatistics               | ptexistvisimap | ptexistexttoast 
-------------+------------+-----------------------------------------+----------------+-----------------
 0           |        340 | [(false,false),(340),(5,997),(172558)]  | f              | f
 0           |        322 | [(false,false),(322),(1,998),(161280)]  | f              | f
 0           |        338 | [(false,false),(338),(2,1000),(166662)] | f              | f
(3 rows)

drop table t_int2;
create table t_int4(v1 int4) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int4 values(generate_series(1001, 2000));
select * from get_pax_aux_table('t_int4');
 ptblockname | pttupcount |                ptstatistics                | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------+----------------+-----------------
 0           |        335 | [(false,false),(335),(1013,2000),(507879)] | f              | f
 0           |        334 | [(false,false),(334),(1002,1995),(493353)] | f              | f
 0           |        331 | [(false,false),(331),(1001,1997),(499268)] | f              | f
(3 rows)

drop table t_int4;
create table t_int8(v1 int8) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int8 values(generate_series(2001, 3000));
select * from get_pax_aux_table('t_int8');
 ptblockname | pttupcount |                ptstatistics                | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------+----------------+-----------------
 0           |        328 | [(false,false),(328),(2001,2997),(816016)] | f              | f
 0           |        340 | [(false,false),(340),(2003,2998),(857576)] | f              | f
 0           |        332 | [(false,false),(332),(2004,3000),(826908)] | f              | f
(3 rows)

drop table t_int8;
create table t_float4(v1 float4) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_float4 values(generate_series(3001, 4000));
select * from get_pax_aux_table('t_float4');
 ptblockname | pttupcount |                   ptstatistics                   | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------------+----------------+-----------------
 0           |        341 | [(false,false),(341),(3001,3998),(1.194769e+06)] | f              | f
 0           |        335 | [(false,false),(335),(3002,4000),(1.169653e+06)] | f              | f
 0           |        324 | [(false,false),(324),(3006,3996),(1.136078e+06)] | f              | f
(3 rows)

drop table t_float4;
create table t_float8(v1 float8) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_float8 values(generate_series(4001, 5000));
select * from get_pax_aux_table('t_float8');
 ptblockname | pttupcount |                ptstatistics                 | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------+----------------+-----------------
 0           |        327 | [(false,false),(327),(4004,5000),(1478798)] | f              | f
 0           |        324 | [(false,false),(324),(4001,4999),(1450686)] | f              | f
 0           |        349 | [(false,false),(349),(4003,4998),(1571016)] | f              | f
(3 rows)

drop table t_float8;
create table t_money(v1 int4, v2 money) with (minmax_columns='v1,v2');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_money values(generate_series(5001, 6000), generate_series(5001, 6000));
select * from get_pax_aux_table('t_money');
 ptblockname | pttupcount |                                      ptstatistics                                      | ptexistvisimap | ptexistexttoast 
-------------+------------+----------------------------------------------------------------------------------------+----------------+-----------------
 0           |        348 | [(false,false),(348),(5002,6000),(1913581)],[(false,false),(348),None,($1,913,581.00)] | f              | f
 0           |        311 | [(false,false),(311),(5007,5995),(1712187)],[(false,false),(311),None,($1,712,187.00)] | f              | f
 0           |        341 | [(false,false),(341),(5001,5997),(1874732)],[(false,false),(341),None,($1,874,732.00)] | f              | f
(3 rows)

drop table t_money;
create table t_interval(v1 interval) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_interval values 
  (interval '1 seconds'), (interval '2 seconds'), (interval '3 seconds'), (interval '4 seconds'), (interval '5 seconds'), (interval '50 seconds'), 
  (interval '6 minutes'), (interval '7 minutes'), (interval '8 minutes'), (interval '9 minutes'), (interval '10 minutes'), (interval '60 minutes'), 
  (interval '7 hours') , (interval '8 hours') , (interval '9 hours') , (interval '10 hours') , (interval '11 hours') , (interval '400 hours');
select * from get_pax_aux_table('t_interval');
 ptblockname | pttupcount |                     ptstatistics                      | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------+----------------+-----------------
 0           |          4 | [(false,false),(4),None,(@ 12 hours 7 secs)]          | f              | f
 0           |          7 | [(false,false),(7),None,(@ 400 hours 40 mins 5 secs)] | f              | f
 0           |          7 | [(false,false),(7),None,(@ 34 hours 53 secs)]         | f              | f
(3 rows)

drop table t_interval;
reset pax_max_tuples_per_group;
-- 
-- Test with small group
-- 
create table t1(v1 int, v2 text, v3 float8, v4 bool) with (minmax_columns='v1,v2,v3,v4');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 select i,i::text,i::float8, i % 2 > 0 from generate_series(1, 1000)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                                                                      ptstatistics                                                                      | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),(2,1000),(166662)],[(false,false),(338),(1000,999),None],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(f,t),None] | f              | f
 0           |        322 | [(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),None],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(f,t),None]      | f              | f
 0           |        340 | [(false,false),(340),(5,997),(172558)],[(false,false),(340),(10,997),None],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(f,t),None]     | f              | f
(3 rows)

drop table t1;
create table t1(v1 int, v2 float8);
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 values(generate_series(1, 1000), NULL);
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                        ptstatistics                         | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),None,None],[(true,true),(0),None,None] | f              | f
 0           |        322 | [(false,false),(322),None,None],[(true,true),(0),None,None] | f              | f
 0           |        340 | [(false,false),(340),None,None],[(true,true),(0),None,None] | f              | f
(3 rows)

truncate t1;
insert into t1 select NULL, NULL from generate_series(1, 200)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                      ptstatistics                       | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------------------+----------------+-----------------
 0           |        200 | [(true,true),(0),None,None],[(true,true),(0),None,None] | f              | f
(1 row)

truncate t1;
insert into t1 SELECT (CASE WHEN i % 2 > 0 THEN NULL ELSE i END), (CASE WHEN i % 2 < 1 THEN NULL ELSE i END) FROM generate_series(1, 1000)i;
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                         ptstatistics                          | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------------------------+----------------+-----------------
 0           |        670 | [(false,true),(170),None,None],[(false,true),(500),None,None] | f              | f
 0           |        170 | [(false,false),(170),None,None],[(true,true),(0),None,None]   | f              | f
 0           |        160 | [(false,false),(160),None,None],[(true,true),(0),None,None]   | f              | f
(3 rows)

truncate t1;
drop table t1;
create table t1(v1 int2, v2 int4, v3 int8, v4 float4, v5 float8, v6 money, v7 interval) with (minmax_columns='v1,v2,v3,v4,v5,v6,v7');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t1 values(generate_series(1, 1000), generate_series(1, 1000), generate_series(1, 1000), 
  generate_series(1, 1000), generate_series(1, 1000), generate_series(1, 1000), (interval '3 seconds'));
select * from get_pax_aux_table('t1');
 ptblockname | pttupcount |                                                                                                                                          ptstatistics                                                                                                                                           | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------
 0           |        338 | [(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),(2,1000),(166662)],[(false,false),(338),None,($166,662.00)],[(false,false),(338),None,(@ 16 mins 54 secs)] | f              | f
 0           |        322 | [(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),(1,998),(161280)],[(false,false),(322),None,($161,280.00)],[(false,false),(322),None,(@ 16 mins 6 secs)]       | f              | f
 0           |        340 | [(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),(5,997),(172558)],[(false,false),(340),None,($172,558.00)],[(false,false),(340),None,(@ 17 mins)]              | f              | f
(3 rows)

drop table t1;
create table t_int2(v1 int2) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int2 values(generate_series(1, 1000));
select * from get_pax_aux_table('t_int2');
 ptblockname | pttupcount |              ptstatistics               | ptexistvisimap | ptexistexttoast 
-------------+------------+-----------------------------------------+----------------+-----------------
 0           |        322 | [(false,false),(322),(1,998),(161280)]  | f              | f
 0           |        338 | [(false,false),(338),(2,1000),(166662)] | f              | f
 0           |        340 | [(false,false),(340),(5,997),(172558)]  | f              | f
(3 rows)

drop table t_int2;
create table t_int4(v1 int4) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int4 values(generate_series(1001, 2000));
select * from get_pax_aux_table('t_int4');
 ptblockname | pttupcount |                ptstatistics                | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------+----------------+-----------------
 0           |        334 | [(false,false),(334),(1002,1995),(493353)] | f              | f
 0           |        335 | [(false,false),(335),(1013,2000),(507879)] | f              | f
 0           |        331 | [(false,false),(331),(1001,1997),(499268)] | f              | f
(3 rows)

drop table t_int4;
create table t_int8(v1 int8) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_int8 values(generate_series(2001, 3000));
select * from get_pax_aux_table('t_int8');
 ptblockname | pttupcount |                ptstatistics                | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------+----------------+-----------------
 0           |        328 | [(false,false),(328),(2001,2997),(816016)] | f              | f
 0           |        340 | [(false,false),(340),(2003,2998),(857576)] | f              | f
 0           |        332 | [(false,false),(332),(2004,3000),(826908)] | f              | f
(3 rows)

drop table t_int8;
create table t_float4(v1 float4) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_float4 values(generate_series(3001, 4000));
select * from get_pax_aux_table('t_float4');
 ptblockname | pttupcount |                   ptstatistics                   | ptexistvisimap | ptexistexttoast 
-------------+------------+--------------------------------------------------+----------------+-----------------
 0           |        341 | [(false,false),(341),(3001,3998),(1.194769e+06)] | f              | f
 0           |        324 | [(false,false),(324),(3006,3996),(1.136078e+06)] | f              | f
 0           |        335 | [(false,false),(335),(3002,4000),(1.169653e+06)] | f              | f
(3 rows)

drop table t_float4;
create table t_float8(v1 float8) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_float8 values(generate_series(4001, 5000));
select * from get_pax_aux_table('t_float8');
 ptblockname | pttupcount |                ptstatistics                 | ptexistvisimap | ptexistexttoast 
-------------+------------+---------------------------------------------+----------------+-----------------
 0           |        324 | [(false,false),(324),(4001,4999),(1450686)] | f              | f
 0           |        327 | [(false,false),(327),(4004,5000),(1478798)] | f              | f
 0           |        349 | [(false,false),(349),(4003,4998),(1571016)] | f              | f
(3 rows)

drop table t_float8;
create table t_money(v1 int4, v2 money) with (minmax_columns='v1,v2');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into t_money values(generate_series(5001, 6000), generate_series(5001, 6000));
select * from get_pax_aux_table('t_money');
 ptblockname | pttupcount |                                      ptstatistics                                      | ptexistvisimap | ptexistexttoast 
-------------+------------+----------------------------------------------------------------------------------------+----------------+-----------------
 0           |        348 | [(false,false),(348),(5002,6000),(1913581)],[(false,false),(348),None,($1,913,581.00)] | f              | f
 0           |        311 | [(false,false),(311),(5007,5995),(1712187)],[(false,false),(311),None,($1,712,187.00)] | f              | f
 0           |        341 | [(false,false),(341),(5001,5997),(1874732)],[(false,false),(341),None,($1,874,732.00)] | f              | f
(3 rows)

drop table t_money;
create table t_interval(v1 interval) with (minmax_columns='v1');
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'v1' as the Cloudberry Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
-- 15sec + 50sec + 40mins + 60 mins + 45hrs + 400hrs
insert into t_interval values 
  (interval '1 seconds'), (interval '2 seconds'), (interval '3 seconds'), (interval '4 seconds'), (interval '5 seconds'), (interval '50 seconds'), 
  (interval '6 minutes'), (interval '7 minutes'), (interval '8 minutes'), (interval '9 minutes'), (interval '10 minutes'), (interval '60 minutes'), 
  (interval '7 hours') , (interval '8 hours') , (interval '9 hours') , (interval '10 hours') , (interval '11 hours') , (interval '400 hours');
select * from get_pax_aux_table('t_interval');
 ptblockname | pttupcount |                     ptstatistics                      | ptexistvisimap | ptexistexttoast 
-------------+------------+-------------------------------------------------------+----------------+-----------------
 0           |          7 | [(false,false),(7),None,(@ 400 hours 40 mins 5 secs)] | f              | f
 0           |          7 | [(false,false),(7),None,(@ 34 hours 53 secs)]         | f              | f
 0           |          4 | [(false,false),(4),None,(@ 12 hours 7 secs)]          | f              | f
(3 rows)

drop table t_interval;
